# Optimize Slack

This repo attempts to improve the slack that's often found in curricula at UCSD. Slack is the distance between a course and its prereq - large distances are inefficient and counter-productive because students will have forgotten the prerequisite knowledge by the time they take the second course. 

Obviously this is not easy to do by hand, or we would have done it already. There are several priorities and validity conditions that alter how you can optimize the curricula - for example, packing 24 units in a quarter for the sake of reducing slack isn't an optimal choice. 

This repo uses Curricular Analytics and Gurobi Optimizer. The gist of the process is to turn the Curricular Analytics graphs into matrices and then optimize those with well known iterative algorithms while adhering to a set of conditions. 

A lot of this work is just a python port of work done by the original Curricular Analytics team. The explanations of the cost functions used and the conditions can be found on an old old commit in the [Curricular Analytics github](https://github.com/CurricularAnalytics/CurricularAnalytics.jl/blob/v0.6.6/docs/src/degreeplans.md). I think they might've removed it to make it a paid feature or maybe to debug it, but I can't really say. All I can say is it works for us. I've also included the document in this repo in case anything happens. See that for an explanation of the cost functions we can use and the math behind the optimization.

I believe that of the three cost functions described there, balance and slack (requisite distance) are the supported ones. I think that the toxic course avoidance we don't have the necessary 'toxicity' data to test and use the function. In theory it should work though. 

All of the optimization code is provided in the file ```chat_optimize.py```. ```test.py``` is for testing one or two curricula at once and ```all_test.py``` will sweep across a file structure and attempt to optimize all the plans it can find. It compiles results in csv format as well as JSON, and it has a function to "url-ize" the degree plans so they can be visualized using Sean's curricular grapher tool. The default base link included points to the UCSD-specific hosting of that tool, but you can change that.

The tool also supports specifying the that a given course $x$ has to occur in term $i$ or in a range $[i,j]$. Currently 'canonical' results are using only the prereq objective function, not the balance. The cap of 20 units per term seems to serve well for UCSD plans, and the balance function makes the whole thing take forever. 

Currently the 'canonical' results don't make use of ranged course specifications. Don't have the information to make those specifications since they are highly curriculum-dependent (try sweeping across the UCSD curricula with a range of (current_term-5, current_term + 5) for any non-fixed course and see how many of those models are infeasible. It seems that there's a few that simply have an average credit per term count that's higher than 18 so the model fails the no-more-than-18-per-term requirement), but if they were given they're easy to incorporate. Might be worth incorporating to the single ```test.py``` file if you need it. I've thought of doing something like lower divs stay in the first half of the program. Right now I grab the 'isolate courses' ,i.e. the ones that have no prereqs or dependencies (i.e. electives) and keep them fixed and try to move everything else around. I chose to keep electives fixed because there's no real difference to making elective 1 and elective 2 switch places and the tool often tries to place things like 'Upper division technical elective' into the first quarter, which obviously makes no sense. Once we have more information about elective content in the curricular, we will take a look at optimizing the curricula with min and max elective configurations included. 
